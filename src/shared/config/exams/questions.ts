import type { ExamQuestion } from '@/entities/exam';

type SingleTopic = {
  prompt: string;
  options: string[];
  correctIndex: number;
  tags: string[];
  explanation: string;
};

type MultiTopic = {
  prompt: string;
  options: string[];
  correctIndexes: number[];
  tags: string[];
  explanation: string;
};

type OrderingTopic = {
  prompt: string;
  options: string[];
  correctOrder: number[];
  tags: string[];
  explanation: string;
};

type CaseTopic = {
  prompt: string;
  options: string[];
  correctIndex: number;
  tags: string[];
  explanation: string;
};

type SectionTopics = {
  single: SingleTopic[];
  multi: MultiTopic[];
  ordering: OrderingTopic;
  case: CaseTopic;
};

const optionId = (index: number): string => String.fromCharCode(97 + index);

const makeOptions = (texts: string[]) =>
  texts.map((text, index) => ({
    id: optionId(index),
    text,
  }));

const createId = (prefix: string, index: number): string =>
  `${prefix}${String(index).padStart(3, '0')}`;

const makeSingle = (id: string, topic: SingleTopic): ExamQuestion => ({
  id,
  type: 'singleChoice',
  prompt: topic.prompt,
  options: makeOptions(topic.options),
  correctOptionId: optionId(topic.correctIndex),
  explanation: topic.explanation,
  tags: topic.tags,
});

const makeCase = (id: string, topic: CaseTopic): ExamQuestion => ({
  id,
  type: 'caseDecision',
  prompt: topic.prompt,
  options: makeOptions(topic.options),
  correctOptionId: optionId(topic.correctIndex),
  explanation: topic.explanation,
  tags: topic.tags,
});

const makeMulti = (id: string, topic: MultiTopic): ExamQuestion => ({
  id,
  type: 'multiChoice',
  prompt: topic.prompt,
  options: makeOptions(topic.options),
  correctOptionIds: topic.correctIndexes.map(optionId),
  explanation: topic.explanation,
  tags: topic.tags,
});

const makeOrdering = (id: string, topic: OrderingTopic): ExamQuestion => ({
  id,
  type: 'ordering',
  prompt: topic.prompt,
  options: makeOptions(topic.options),
  correctOrderOptionIds: topic.correctOrder.map(optionId),
  explanation: topic.explanation,
  tags: topic.tags,
});

const buildSection = (prefix: string, topics: SectionTopics): ExamQuestion[] => [
  ...topics.single.map((topic, index) => makeSingle(createId(prefix, index + 1), topic)),
  ...topics.multi.map((topic, index) => makeMulti(createId(prefix, index + 11), topic)),
  makeOrdering(createId(prefix, 14), topics.ordering),
  makeCase(createId(prefix, 15), topics.case),
];

const GENERAL_SINGLE: SingleTopic[] = [
  {
    prompt: 'Две задачи конфликтуют по срокам и объему. ',
    options: [
      'Спросите заинтересованные стороны о влиянии и выберите по ценности',
      'Выберите самую легкую задачу',
      'Делайте и то, и другое без обсуждения',
      'Задержка молча',
    ],
    correctIndex: 0,
    tags: ['general', 'prioritization'],
    explanation: 'Уточнение воздействия и ценности позволяет прийти к осознанному компромиссу.',
  },
  {
    prompt: 'История неясна. ',
    options: [
      'Запустите всплеск с ограничением по времени, чтобы уменьшить неопределенность',
      'Угадай число быстро',
      'Отказ от оценки вообще',
      'Удвойте аналогичную оценку без исследований',
    ],
    correctIndex: 0,
    tags: ['general', 'planning'],
    explanation: 'Короткий всплеск дает доказательства и снижает риск оценки.',
  },
  {
    prompt: 'Во время проверки кода вы не видите тестов на критические изменения. ',
    options: [
      'Попросите добавить тесты',
      'Одобрить и исправить позже',
      'Перепишите код самостоятельно',
      'игнорировать',
    ],
    correctIndex: 0,
    tags: ['general', 'code-review'],
    explanation: 'Тесты являются частью определения того, что сделано для критических изменений.',
  },
  {
    prompt: 'В отчете об ошибке говорится, что «он выходит из строя». ',
    options: [
      'Запросить шаги и сведения о среде',
      'Закрыть как недействительный',
      'Исправить без воспроизведения',
      'Ждите новых жалоб',
    ],
    correctIndex: 0,
    tags: ['general', 'bugs'],
    explanation: 'Для диагностики проблемы необходимы шаги воспроизведения и контекст.',
  },
  {
    prompt: 'Вы понимаете, что дедлайн под угрозой. ',
    options: [
      'Общайтесь заранее и согласовывайте объем',
      'Работайте в выходные спокойно',
      'Скрыть риск',
      'Обвинять зависимости позже',
    ],
    correctIndex: 0,
    tags: ['general', 'communication'],
    explanation: 'Раннее общение позволяет корректировать объем или сроки.',
  },
  {
    prompt: 'CI выходит из строя после слияния в основной системе. ',
    options: [
      'Исправьте или откатите, чтобы восстановить зеленый цвет',
      'Игнор до завтра',
      'Отключить CI',
      'Добавить больше вакансий',
    ],
    correctIndex: 0,
    tags: ['general', 'ci'],
    explanation: 'Сохранение основной ветви зеленым предотвращает каскадные сбои.',
  },
  {
    prompt: 'Вы получите производственное предупреждение. ',
    options: [
      'Влияние пользователя и частота ошибок',
      'Начать рефакторинг',
      'Перезагрузить серверы',
      'Отключить оповещения',
    ],
    correctIndex: 0,
    tags: ['general', 'monitoring'],
    explanation: 'Оценка воздействия определяет правильный уровень реагирования.',
  },
  {
    prompt: 'Необходимо выпустить рискованное изменение. ',
    options: [
      'Флаг функции с откатом',
      'Развертывание в пятницу',
      'Пропустить тестирование',
      'Хардкод',
    ],
    correctIndex: 0,
    tags: ['general', 'release'],
    explanation: 'Флаги функций позволяют выполнить быстрый откат без повторного развертывания.',
  },
  {
    prompt: 'Слишком много статусных встреч тратят время. ',
    options: [
      'Переместить обновления статуса асинхронно',
      'Добавить еще одну встречу',
      'Перестаньте общаться',
      'Только пишите менеджеру',
    ],
    correctIndex: 0,
    tags: ['general', 'workflow'],
    explanation:
      'Асинхронные обновления уменьшают переключение контекста, сохраняя при этом видимость.',
  },
  {
    prompt: 'Требование неоднозначное. ',
    options: [
      'Напишите критерии приемки вместе с продуктом',
      'Реализуйте предположения молча',
      'Подождите, пока QA примет решение',
      'Попросите другого инженера угадать',
    ],
    correctIndex: 0,
    tags: ['general', 'requirements'],
    explanation: 'Четкие критерии приемки предотвращают переделки и несоответствие ожиданий.',
  },
  {
    prompt: 'Технический долг замедляет поставки. ',
    options: [
      'Планируйте небольшие рефакторинги внутри итераций.',
      'Переписывание Большого взрыва',
      'Игнорировать навсегда',
      'Рефакторинг без тестов',
    ],
    correctIndex: 0,
    tags: ['general', 'quality'],
    explanation:
      'Небольшие запланированные рефакторинги снижают риск и одновременно повышают скорость.',
  },
  {
    prompt: 'Присоединяется новый товарищ по команде. ',
    options: [
      'Сопряжение плюс четкие документы и цели',
      'Дайте огромную задачу в одиночку',
      'Доступа нет до второй недели.',
      'Подождите, пока они зададут вопросы',
    ],
    correctIndex: 0,
    tags: ['general', 'team'],
    explanation:
      'Управляемая адаптация ускоряет ввод в эксплуатацию и уменьшает количество ошибок.',
  },
];

const GENERAL_MULTI: MultiTopic[] = [
  {
    prompt: 'Что входит в хорошее PR-описание? ',
    options: [
      'Что и почему краткое содержание',
      'Как протестировать',
      'Скриншоты изменений пользовательского интерфейса',
      'Только «пожалуйста, просмотрите»',
    ],
    correctIndexes: [0, 1, 2],
    tags: ['general', 'code-review'],
    explanation:
      'Информация о контексте и тестировании делает проверки эффективными и безопасными.',
  },
  {
    prompt: 'Какие действия необходимы во время реагирования на инцидент? ',
    options: [
      'Смягчение воздействия на пользователей',
      'Статус сообщения',
      'Временная шкала документа',
      'Спорить о вине',
    ],
    correctIndexes: [0, 1, 2],
    tags: ['general', 'incident'],
    explanation:
      'Смягчение последствий, коммуникация и документирование являются основными этапами инцидента.',
  },
  {
    prompt: 'Подробный отчет об ошибке включает в себя: (Выбрать все)',
    options: [
      'Шаги по воспроизведению',
      'Ожидаемое против фактического',
      'Детали окружающей среды',
      'Только предположение о первопричине',
    ],
    correctIndexes: [0, 1, 2],
    tags: ['general', 'bugs'],
    explanation: 'Для сортировки необходимы этапы воспроизведения, ожидания и контекст.',
  },
  {
    prompt: 'Способы уменьшения переключения контекста: (Выбрать все)',
    options: [
      'Ограничить незавершенное производство',
      'Пакетные уведомления',
      'Блокировать время фокусировки',
      'Всегда держите чат открытым',
    ],
    correctIndexes: [0, 1, 2],
    tags: ['general', 'workflow'],
    explanation: 'Сокращение перебоев увеличивает пропускную способность и качество.',
  },
  {
    prompt: 'Контрольный список выпуска должен включать: (Выбрать все)',
    options: [
      'План отката',
      'Мониторинг и оповещения',
      'Поэтапное внедрение',
      'Пропустите контроль качества, чтобы сэкономить время',
    ],
    correctIndexes: [0, 1, 2],
    tags: ['general', 'release'],
    explanation: 'Откат и мониторинг снижают риск во время развертывания.',
  },
  {
    prompt: 'Хороший отзыв: (Выбрать все)',
    options: ['Специфический', 'уважительный', 'Действенный', 'Персональный'],
    correctIndexes: [0, 1, 2],
    tags: ['general', 'communication'],
    explanation: 'Профессиональная, действенная обратная связь улучшает результаты.',
  },
];

const GENERAL_CASE: CaseTopic[] = [
  {
    prompt: 'Продукту нужна большая функция до наступления жесткого срока. ',
    options: [
      'Разделение на MVP и последующую работу',
      'Обещайте полный объем в любом случае',
      'Скажи «нет» без альтернатив',
      'Отправка без тестирования',
    ],
    correctIndex: 0,
    tags: ['general', 'prioritization'],
    explanation: 'Выбор MVP позволяет сохранить сроки и одновременно снизить риск.',
  },
  {
    prompt: 'Товарищ по команде неоднократно нарушает сроки. ',
    options: [
      'Имейте 1:1 и согласуйте ожидания',
      'Публично опозорить товарища по команде',
      'Игнорировать и скрывать их работу',
      'Эскалация без разговоров',
    ],
    correctIndex: 0,
    tags: ['general', 'team'],
    explanation: 'Прямая, уважительная обратная связь — самый конструктивный первый шаг.',
  },
];

const GENERAL_QUESTIONS: ExamQuestion[] = [
  ...GENERAL_SINGLE.map((topic, index) => makeSingle(createId('q_gen_', index + 1), topic)),
  ...GENERAL_MULTI.map((topic, index) => makeMulti(createId('q_gen_', index + 13), topic)),
  ...GENERAL_CASE.map((topic, index) => makeCase(createId('q_gen_', index + 19), topic)),
];

const FRONTEND_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Большой список перерисовывается при каждом нажатии клавиши. ',
      options: [
        'Запоминайте строки и обеспечивайте стабильность обработчиков',
        'Переместить список в глобальное состояние',
        'Отключить ввод текста',
        'Используйте setInterval для пакетного рендеринга',
      ],
      correctIndex: 0,
      tags: ['frontend', 'performance'],
      explanation: 'Мемоизация и стабильные реквизиты уменьшают количество ненужных рендеров.',
    },
    {
      prompt: 'LCP высок, потому что изображения героев тяжелые. ',
      options: [
        'Оптимизация и отложенная загрузка изображений',
        'Добавьте больше шрифтов',
        'Отключить кеширование',
        'Увеличьте CSS-анимацию',
      ],
      correctIndex: 0,
      tags: ['frontend', 'performance'],
      explanation: 'Изображения меньшего размера и отложенная загрузка улучшают LCP.',
    },
    {
      prompt: 'Кнопка, состоящая только из значков, недоступна. ',
      options: [
        'Добавить aria-метку',
        'Увеличить только размер шрифта',
        'Удалить кнопку',
        'Используйте div вместо кнопки',
      ],
      correctIndex: 0,
      tags: ['frontend', 'accessibility'],
      explanation: 'Программам чтения с экрана требуются доступные метки.',
    },
    {
      prompt: 'Два удаленных компонента нуждаются в общем состоянии. ',
      options: [
        'Перенести к общему родителю или в магазин',
        'Дублирующееся состояние в обоих компонентах',
        'Используйте глобальные параметры окна',
        'Передавать данные только через URL',
      ],
      correctIndex: 0,
      tags: ['frontend', 'state'],
      explanation: 'Единый источник истины позволяет избежать десинхронизации.',
    },
    {
      prompt: 'Проверка формы происходит только на сервере. ',
      options: [
        'Проверка на клиенте и сервере',
        'Только клиент',
        'Только сервер без обратной связи',
        'Отключить проверку',
      ],
      correctIndex: 0,
      tags: ['frontend', 'forms'],
      explanation: 'Проверка клиента улучшает UX; ',
    },
    {
      prompt: 'Исходный пакет JS слишком велик. ',
      options: [
        'Маршруты/компоненты отложенной загрузки',
        'Встроить все ресурсы',
        'Отладка сборки отладки',
        'Отключить кеширование',
      ],
      correctIndex: 0,
      tags: ['frontend', 'performance'],
      explanation: 'Отложенная загрузка уменьшает начальную полезную нагрузку.',
    },
    {
      prompt: 'Текст внутри гибкого элемента обрезается. ',
      options: [
        'Добавьте минимальную ширину: 0 к гибкому дочернему элементу.',
        'Установить фиксированную ширину везде',
        'Увеличить размер шрифта',
        'Удалить гибкий макет',
      ],
      correctIndex: 0,
      tags: ['frontend', 'css'],
      explanation:
        'Для гибких элементов требуется минимальная ширина: 0, чтобы можно было сжиматься.',
    },
    {
      prompt: 'Необходимо предотвратить XSS в пользовательском контенте. ',
      options: [
        'Экранируйте вывод и избегайте внутреннего HTML',
        'Хранить в localStorage',
        'Используйте только запросы GET',
        'Отключить CSP',
      ],
      correctIndex: 0,
      tags: ['frontend', 'security'],
      explanation: 'Экранирование ненадежного содержимого блокирует внедрение сценария.',
    },
    {
      prompt: 'Приложение вылетает из-за ошибки рендеринга. ',
      options: [
        'Добавить границу ошибки с резервным вариантом',
        'Удалить попытку/ловлю',
        'Игнорировать ошибки',
        'Перезагрузить каждый рендер',
      ],
      correctIndex: 0,
      tags: ['frontend', 'reliability'],
      explanation: 'Границы ошибок предотвращают сбой всего приложения.',
    },
    {
      prompt: 'Повторные вызовы API при фокусировке вызывают мерцание. ',
      options: [
        'Использовать кеш с устаревшим при повторной проверке',
        'Отключить кеширование',
        'Опрос каждую секунду',
        'Хранить на витрине',
      ],
      correctIndex: 0,
      tags: ['frontend', 'data'],
      explanation:
        'Кэширование уменьшает ненужную повторную выборку, сохраняя при этом актуальность данных.',
    },
  ],
  multi: [
    {
      prompt: 'Какие действия улучшают производительность в Интернете? ',
      options: [
        'Разделение кода',
        'Запомните тяжелые компоненты',
        'Уменьшите мусор с макетом',
        'Добавьте скрипты блокировки',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['frontend', 'performance'],
      explanation: 'Уменьшение размера пакета и работы по макету повышает производительность.',
    },
    {
      prompt: 'Проверки доступности включают: (Выбрать все)',
      options: [
        'Навигация с помощью клавиатуры',
        'Видимый фокус',
        'Правильные этикетки',
        'Удалить семантический HTML',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['frontend', 'accessibility'],
      explanation: 'Доступ к клавиатуре и маркировка необходимы для обеспечения доступности.',
    },
    {
      prompt: 'К запахам управления состоянием относятся: (Выбрать все)',
      options: [
        'Дублированный источник истины',
        'Хранение производных данных',
        'Неограниченное глобальное состояние',
        'Локальный штат с ограниченной областью действия',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['frontend', 'state'],
      explanation: 'Дублированное или глобализированное состояние часто приводит к ошибкам.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите шаги по устранению критической регрессии пользовательского интерфейса.',
    options: [
      'Воспроизвести проблему',
      'Определите изменение или откат',
      'Применить исправление',
      'Добавьте регрессионный тест',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['frontend', 'incident'],
    explanation: 'Воспроизводите, смягчайте, исправляйте, а затем предотвращайте регрессию.',
  },
  case: {
    prompt: 'Маркетингу сегодня нужен новый баннер с риском макета. ',
    options: [
      'Отправляйте с флагом функции и монитором',
      'Жесткий код непосредственно в основной',
      'Пропустить обзор и тесты',
      'Удалить ограничения CSS',
    ],
    correctIndex: 0,
    tags: ['frontend', 'release'],
    explanation: 'Флаги функций снижают риск при соблюдении срочности.',
  },
};

const FRONTEND_SECTION = buildSection('q_fe_', FRONTEND_TOPICS);

const BACKEND_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Повторные попытки клиента могут создавать дубликаты. ',
      options: [
        'Используйте ключи идемпотентности',
        'Увеличить таймаут',
        'Отключить повторные попытки',
        'Войти больше',
      ],
      correctIndex: 0,
      tags: ['backend', 'api'],
      explanation: 'Ключи идемпотентности делают повторные попытки безопасными.',
    },
    {
      prompt: 'Необходимо обновить две таблицы атомарно. ',
      options: [
        'Использовать транзакцию базы данных',
        'Два отдельных запроса',
        'Только кэш',
        'Только асинхронное задание',
      ],
      correctIndex: 0,
      tags: ['backend', 'database'],
      explanation: 'Транзакции гарантируют атомарность.',
    },
    {
      prompt: 'Конечная точка с интенсивным чтением работает медленно. ',
      options: [
        'Используйте кэш-память',
        'Отключить индексы',
        'Увеличить размер ответа',
        'Добавить журналы отладки',
      ],
      correctIndex: 0,
      tags: ['backend', 'performance'],
      explanation: 'Кэширование снижает нагрузку на повторное чтение.',
    },
    {
      prompt: 'Защитите API от злоупотреблений. ',
      options: [
        'Применить ограничение скорости',
        'Вернуть большую полезную нагрузку',
        'Удалить авторизацию',
        'Разрешить неограниченное количество запросов',
      ],
      correctIndex: 0,
      tags: ['backend', 'security'],
      explanation: 'Ограничение скорости контролирует неправомерный трафик.',
    },
    {
      prompt: 'Обработка изображений на пути запроса выполняется медленно. ',
      options: [
        'Перейти в асинхронную рабочую очередь',
        'Заблокировать цепочку запросов',
        'Отключить загрузку',
        'Увеличить размер JSON',
      ],
      correctIndex: 0,
      tags: ['backend', 'scaling'],
      explanation: 'Фоновые работники поддерживают низкую задержку API.',
    },
    {
      prompt: 'Нужна нумерация страниц для больших наборов данных. ',
      options: [
        'Используйте нумерацию страниц на основе курсора',
        'Вернуть все товары',
        'Случайное смещение',
        'Пейджинг только для клиента',
      ],
      correctIndex: 0,
      tags: ['backend', 'api'],
      explanation: 'Пагинация курсора лучше масштабируется для больших таблиц.',
    },
    {
      prompt: 'Обнаружена проблема с запросом N+1. ',
      options: [
        'Пакетная загрузка или присоединение',
        'Добавьте больше петель',
        'Отключить ОРМ',
        'Добавить сон',
      ],
      correctIndex: 0,
      tags: ['backend', 'database'],
      explanation: 'Пакетная обработка уменьшает количество избыточных запросов.',
    },
    {
      prompt: 'Изменение схемы с учетом существующих данных. ',
      options: [
        'Добавьте столбец с нулевым значением, затем заполните его',
        'Немедленно удалить столбец',
        'Редактировать производство вручную',
        'Переименование без миграции',
      ],
      correctIndex: 0,
      tags: ['backend', 'database'],
      explanation: 'Обратная совместимость изменений снижает риск простоя.',
    },
    {
      prompt: 'Необходимо отслеживать запросы между службами. ',
      options: [
        'Распространение идентификатора корреляции',
        'Регистрировать только ошибки',
        'Отключить отслеживание',
        'Использовать случайный идентификатор для каждой строки журнала',
      ],
      correctIndex: 0,
      tags: ['backend', 'observability'],
      explanation: 'Идентификаторы корреляции связывают журналы и трассировки между службами.',
    },
    {
      prompt: 'Нужна надежная публикация событий после записи в БД. ',
      options: [
        'Использовать шаблон исходящих сообщений',
        'Публикация перед фиксацией',
        'только Крон',
        'Игнорировать неудачи',
      ],
      correctIndex: 0,
      tags: ['backend', 'reliability'],
      explanation: 'Исходящие гарантируют, что события не будут потеряны в случае сбоя.',
    },
  ],
  multi: [
    {
      prompt: 'К хорошим практикам проектирования API относятся: (Выберите все)',
      options: [
        'Последовательные коды ошибок',
        'Пагинация',
        'Управление версиями',
        'Изменение ответов молча',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['backend', 'api'],
      explanation:
        'Согласованность и управление версиями уменьшают количество критических изменений.',
    },
    {
      prompt: 'Как уменьшить грохот стада? ',
      options: [
        'Кэш с TTL',
        'Запросить объединение',
        'Автоматический выключатель',
        'Отключить кеширование',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['backend', 'performance'],
      explanation:
        'Кэширование и объединение запросов уменьшают синхронизированные скачки нагрузки.',
    },
    {
      prompt: 'Проверка ввода должна: (Выбрать все)',
      options: [
        'Подтвердить на сервере',
        'Использовать проверку схемы',
        'Обеззараживание пользовательского ввода',
        'Доверять только клиенту',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['backend', 'security'],
      explanation: 'Проверка на стороне сервера необходима для обеспечения безопасности.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите действия при инциденте с базой данных.',
    options: [
      'Обнаружение и оценка воздействия',
      'Смягчение с помощью аварийного переключения или отката',
      'Статус сообщения',
      'Устраните основную причину и примите меры',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['backend', 'incident'],
    explanation: 'Оцените, смягчите, сообщите, затем разрешите и учитесь.',
  },
  case: {
    prompt: 'Пользователи сообщают о дублирующих платежах из-за повторных попыток. ',
    options: [
      'Добавьте ключи идемпотентности и выполните дедупликацию',
      'Полностью отключить платежи',
      'Игнорировать дубликаты',
      'Увеличить только таймаут',
    ],
    correctIndex: 0,
    tags: ['backend', 'payments'],
    explanation: 'Идемпотентность предотвращает дублирование при повторных попытках.',
  },
};

const BACKEND_SECTION = buildSection('q_be_', BACKEND_TOPICS);

const FULLSTACK_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Пользовательский интерфейс показывает устаревшие данные после обновлений. ',
      options: [
        'Определите единый источник истины и аннулируйте кеш',
        'Дублирующееся состояние в пользовательском интерфейсе и API',
        'Значения жесткого кода в пользовательском интерфейсе',
        'Игнорировать проблему',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'data'],
      explanation: 'Единый источник достоверных данных позволяет избежать дрейфа данных.',
    },
    {
      prompt: 'Нужны агрегированные данные из нескольких сервисов. ',
      options: [
        'Используйте BFF для агрегирования',
        'Вызов всех служб из пользовательского интерфейса',
        'Хардкод в пользовательском интерфейсе',
        'Отключить аутентификацию',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'architecture'],
      explanation: 'BFF снижает сложность клиента и разветвление запросов.',
    },
    {
      prompt: 'Аутентификация для SPA требует безопасности. ',
      options: [
        'Используйте файлы cookie httpOnly или безопасное хранилище с обновлением.',
        'Храните токены только в localStorage.',
        'Поместите токен в URL',
        'Отключить HTTPS',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'security'],
      explanation: 'Безопасное хранение и ротация снижают риск кражи токенов.',
    },
    {
      prompt: 'Загрузка больших файлов происходит медленно. ',
      options: [
        'Используйте предварительно подписанный URL-адрес и прямую загрузку.',
        'Отправка через полезную нагрузку JSON',
        'Разделить на множество сообщений формы',
        'Блокировать пользовательский интерфейс до завершения загрузки',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'performance'],
      explanation: 'Прямая загрузка позволяет избежать узких мест API.',
    },
    {
      prompt: 'Страница работает медленно из-за большого количества запросов. ',
      options: [
        'Разбивка на страницы и ленивая загрузка',
        'Загрузите все предметы одновременно',
        'Увеличьте CSS',
        'Отключить кеш',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'performance'],
      explanation: 'Пагинация уменьшает полезную нагрузку и нагрузку на сервер.',
    },
    {
      prompt: 'Ошибки несовместимы между API и пользовательским интерфейсом. ',
      options: [
        'Стандартизировать форму ошибки',
        'Пусть каждая команда решит',
        'Возвращать ошибки HTML',
        'Скрыть ошибки',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'api'],
      explanation: 'Стандартные ошибки улучшают обработку и UX.',
    },
    {
      prompt: 'Статические активы работают медленно во всем мире. ',
      options: [
        'Используйте CDN и заголовки кэширования',
        'Отключить кеширование',
        'Объединение только в JS',
        'Обслуживание из БД',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'performance'],
      explanation: 'CDN уменьшают задержку и повышают скорость попадания в кеш.',
    },
    {
      prompt: 'Валидация дублируется в FE и BE. ',
      options: [
        'Схема проверки общего доступа',
        'Пропустить проверку',
        'Подтверждать только в пользовательском интерфейсе',
        'Проверять только в БД',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'quality'],
      explanation: 'Общие схемы уменьшают дрейф и ошибки.',
    },
    {
      prompt: 'Требуется SEO для маркетинговой страницы. ',
      options: [
        'Используйте SSR или SSG',
        'Только чистая КСО',
        'Отключить метаданные',
        'Скрыть контент',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'frontend'],
      explanation: 'SSR или SSG улучшают возможность сканирования и начальную загрузку.',
    },
    {
      prompt: 'Требуется сквозное отслеживание. ',
      options: [
        'Передача идентификатора корреляции из пользовательского интерфейса через API',
        'Войти только через интерфейс',
        'Войти только через серверную часть',
        'Отключить журналы',
      ],
      correctIndex: 0,
      tags: ['fullstack', 'observability'],
      explanation: 'Идентификаторы корреляции связывают действия пользователя со следами сервера.',
    },
  ],
  multi: [
    {
      prompt: 'Контрольный список выпуска Fullstack включает в себя: (Выбрать все)',
      options: [
        'Запуск миграции',
        'Развертывание серверной части',
        'Развертывание интерфейса',
        'Пропустить мониторинг',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['fullstack', 'release'],
      explanation: 'Скоординированные развертывания и миграции сокращают число сбоев.',
    },
    {
      prompt: 'Улучшите UX для медленных ответов API: (выбрать все)',
      options: [
        'Загрузка скелета',
        'Оптимистичный интерфейс',
        'Кэширование клиента',
        'Блокировать пользовательский интерфейс без обратной связи',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['fullstack', 'ux'],
      explanation: 'Обратная связь и кэширование уменьшают воспринимаемую задержку.',
    },
    {
      prompt: 'Настройка безопасной аутентификации должна включать: (Выбрать все)',
      options: [
        'httpТолько файлы cookie',
        'CSRF-защита',
        'Ротация токенов',
        'Токен в строке запроса',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['fullstack', 'security'],
      explanation: 'Эти меры защищают от кражи токенов и CSRF.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите шаги по добавлению нового поля сквозным образом.',
    options: [
      'Добавить миграцию БД',
      'Обновить контракт API',
      'Обновить пользовательский интерфейс',
      'Развертывание по порядку',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['fullstack', 'delivery'],
    explanation:
      'Изменения базы данных и API должны предшествовать использованию пользовательского интерфейса.',
  },
  case: {
    prompt: 'Ошибка серверной части нарушает работу страницы для всех пользователей. ',
    options: [
      'Откат серверной части и отображение безопасного резервного пользовательского интерфейса.',
      'Исправление только пользовательского интерфейса',
      'Игнорировать ошибки серверной части',
      'Удалите мониторинг, чтобы прекратить оповещения',
    ],
    correctIndex: 0,
    tags: ['fullstack', 'incident'],
    explanation: 'Откат плюс резервный вариант позволяют быстро восстановить обслуживание.',
  },
};

const FULLSTACK_SECTION = buildSection('q_fs_', FULLSTACK_TOPICS);

const MOBILE_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Пользователи сообщают о разрядке аккумулятора. ',
      options: [
        'Уменьшите фоновый опрос',
        'Увеличение частоты обновления',
        'Отключить спящий режим устройства',
        'Добавьте больше анимаций',
      ],
      correctIndex: 0,
      tags: ['mobile', 'performance'],
      explanation: 'Фоновый опрос является распространенным источником разряда батареи.',
    },
    {
      prompt: 'Требуется автономное использование. ',
      options: [
        'Кэшировать данные и выполнять действия в очереди',
        'Отключить офлайн',
        'Показать пустой экран',
        'Удалить данные',
      ],
      correctIndex: 0,
      tags: ['mobile', 'offline'],
      explanation:
        'Кэширование и организация очередей обеспечивают надежную работу в автономном режиме.',
    },
    {
      prompt: 'Отказ магазина приложений в получении разрешений. ',
      options: [
        'Предоставьте четкое обоснование разрешения',
        'Запросите все разрешения заранее',
        'Скрыть запросы на разрешение',
        'Удалить функцию полностью',
      ],
      correctIndex: 0,
      tags: ['mobile', 'release'],
      explanation: 'Четкое обоснование повышает одобрение и доверие пользователей.',
    },
    {
      prompt: 'Сбой происходит в производстве. ',
      options: [
        'Используйте отчеты о сбоях и отправляйте исправления',
        'Игнорировать аварию',
        'Подождите, пока пользователи отправят электронное письмо',
        'Удалить журналирование',
      ],
      correctIndex: 0,
      tags: ['mobile', 'reliability'],
      explanation: 'Отчеты о сбоях предоставляют доказательства целевого исправления.',
    },
    {
      prompt: 'Холодный старт медленный. ',
      options: [
        'Отложить тяжелую инициализацию',
        'Добавить дополнительную работу при запуске',
        'Загружать все изображения при запуске',
        'Отключить кеширование',
      ],
      correctIndex: 0,
      tags: ['mobile', 'performance'],
      explanation: 'Отсрочка работы сокращает время создания первого кадра.',
    },
    {
      prompt: 'Push-уведомления раздражают пользователей. ',
      options: [
        'Используйте подписку и релевантность',
        'Отправляйте каждую минуту',
        'Отключить отписку',
        'Игнорировать рекомендации',
      ],
      correctIndex: 0,
      tags: ['mobile', 'engagement'],
      explanation: 'Соответствующие сообщения с возможностью подписки сокращают отток клиентов.',
    },
    {
      prompt: 'Сеть нестабильная. ',
      options: [
        'Повторить попытку с экспоненциальной задержкой',
        'Повторить попытку мгновенно и навсегда',
        'Терпите неудачу молча',
        'Полностью заблокируйте пользовательский интерфейс',
      ],
      correctIndex: 0,
      tags: ['mobile', 'network'],
      explanation: 'Откат снижает нагрузку, одновременно повышая надежность.',
    },
    {
      prompt: 'Пользовательский интерфейс зависает во время прокрутки. ',
      options: [
        'Уберите тяжелую работу из основного потока',
        'Добавьте больше теней',
        'Увеличить размер списка',
        'Отключить ускорение графического процессора',
      ],
      correctIndex: 0,
      tags: ['mobile', 'performance'],
      explanation: 'Работа по разгрузке обеспечивает стабильность времени кадра.',
    },
    {
      prompt: 'Безопасность токена на устройстве. ',
      options: [
        'Безопасное хранилище или брелок для ключей',
        'Простые предпочтения',
        'Встроить в двоичный файл приложения',
        'Печать в журналы',
      ],
      correctIndex: 0,
      tags: ['mobile', 'security'],
      explanation: 'Безопасное хранение уменьшает утечку учетных данных.',
    },
    {
      prompt: 'Рискованный выпуск для многих пользователей. ',
      options: [
        'Используйте поэтапное внедрение',
        'Выпуск для всех пользователей',
        'Пропустить проверку качества',
        'Отключить отчеты о сбоях',
      ],
      correctIndex: 0,
      tags: ['mobile', 'release'],
      explanation: 'Поэтапное развертывание уменьшает радиус взрыва.',
    },
  ],
  multi: [
    {
      prompt: 'Способы уменьшения размера приложения: (Выбрать все)',
      options: [
        'Удалить неиспользуемые ресурсы',
        'Разделить по ABI',
        'Сжатие ресурсов',
        'Объединение символов отладки',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['mobile', 'performance'],
      explanation: 'Удаление неиспользуемых ресурсов и сжатие уменьшают размер APK.',
    },
    {
      prompt: 'Рекомендации по автономной синхронизации: (выбрать все)',
      options: [
        'Действия в очереди',
        'Разрешение конфликтов',
        'Интерфейс синхронизации статуса',
        'Отменить изменения пользователя',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['mobile', 'offline'],
      explanation: 'Очереди и обработка конфликтов обеспечивают целостность данных.',
    },
    {
      prompt: 'Доступность для мобильных устройств включает в себя: (Выбрать все)',
      options: [
        'Большие сенсорные цели',
        'Ярлыки программы чтения с экрана',
        'Высокая контрастность',
        'Отключить фокус',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['mobile', 'accessibility'],
      explanation: 'Сенсорные цели и метки имеют ключевое значение для доступности.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите действия по устранению сбоя.',
    options: [
      'Воспроизведение или сбор журналов',
      'Определите основную причину',
      'Исправьте и протестируйте',
      'Выпуск патча',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['mobile', 'debugging'],
    explanation: 'Сначала доказательства, затем исправляйте, тестируйте и выпускайте.',
  },
  case: {
    prompt: 'Пользователи жалуются, что список медленно загружается. ',
    options: [
      'Разбивка на страницы и кэширование результатов',
      'Загрузите все предметы одновременно',
      'Удалить фильтры',
      'Отключить список',
    ],
    correctIndex: 0,
    tags: ['mobile', 'performance'],
    explanation: 'Пагинация и кэширование сокращают время загрузки и использование памяти.',
  },
};

const MOBILE_SECTION = buildSection('q_mob_', MOBILE_TOPICS);

const QA_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Пирамида тестирования предполагает, что большинство тестов должны быть:',
      options: [
        'Модульные тесты',
        'Сквозные тесты',
        'Только вручную',
        'Только снимок пользовательского интерфейса',
      ],
      correctIndex: 0,
      tags: ['qa', 'testing'],
      explanation: 'Модульные тесты выполняются быстро и охватывают большую часть логики.',
    },
    {
      prompt: 'Тест ненадежный. ',
      options: [
        'Удалить общие зависимости состояния и времени',
        'Увеличение таймаута вслепую',
        'игнорировать это',
        'Отключить CI',
      ],
      correctIndex: 0,
      tags: ['qa', 'flaky'],
      explanation: 'Стабилизация основной причины предотвращает будущую нестабильность.',
    },
    {
      prompt: 'Когда следует использовать заглушку вместо макета?',
      options: [
        'Для детерминированных внешних реакций',
        'Для проверки внутренних звонков',
        'Никогда',
        'Всегда используйте макет',
      ],
      correctIndex: 0,
      tags: ['qa', 'test-doubles'],
      explanation: 'Заглушки предоставляют последовательные ответы без проверки поведения.',
    },
    {
      prompt: 'Выберите лучший уровень для критически важных действий пользователя:',
      options: [
        'Сквозные тесты',
        'Только модульные тесты',
        'Только ручные тесты',
        'Никаких тестов',
      ],
      correctIndex: 0,
      tags: ['qa', 'testing'],
      explanation: 'Критически важные потоки требуют сквозного покрытия.',
    },
    {
      prompt: 'Ошибка влияет на поток платежей для многих пользователей. ',
      options: ['Высокий', 'Низкий', 'Тривиальный', 'Косметический'],
      correctIndex: 0,
      tags: ['qa', 'bugs'],
      explanation: 'Высокое воздействие и частота означают высокую серьезность.',
    },
    {
      prompt: 'Когда следует запускать пакет регрессии?',
      options: [
        'До релизов или серьезных изменений',
        'Раз в год',
        'Только после неудач',
        'Никогда',
      ],
      correctIndex: 0,
      tags: ['qa', 'release'],
      explanation: 'Регрессионное тестирование снижает риск релиза.',
    },
    {
      prompt: 'Лучшая практика для тестовых данных?',
      options: [
        'Детерминированные и изолированные данные',
        'Общие изменяемые данные',
        'Случайные неотслеживаемые данные',
        'Только производственные данные',
      ],
      correctIndex: 0,
      tags: ['qa', 'data'],
      explanation: 'Детерминированные данные делают тесты надежными.',
    },
    {
      prompt: 'Исследовательское тестирование наиболее полезно, когда:',
      options: [
        'Сборка стабильная и время есть',
        'Сразу после каждого коммита',
        'Никогда',
        'Только для цветов пользовательского интерфейса',
      ],
      correctIndex: 0,
      tags: ['qa', 'exploratory'],
      explanation:
        'Исследовательское тестирование выявляет проблемы, выходящие за рамки сценариев.',
    },
    {
      prompt: 'Лучшее время для уточнения критериев приемки?',
      options: [
        'Перед планированием тестирования',
        'После выпуска',
        'Только во время сортировки ошибок',
        'Никогда',
      ],
      correctIndex: 0,
      tags: ['qa', 'requirements'],
      explanation: 'Четкие критерии ведут к точному тестированию.',
    },
    {
      prompt: 'Наилучшая рентабельность инвестиций в автоматизацию достигается за счет:',
      options: [
        'Стабильные, повторяющиеся сценарии',
        'Разовые крайние случаи',
        'Редкие ручные потоки',
        'Изменение прототипов',
      ],
      correctIndex: 0,
      tags: ['qa', 'automation'],
      explanation: 'Стабильные сценарии больше всего выигрывают от автоматизации.',
    },
  ],
  multi: [
    {
      prompt: 'Качества хорошего тестового примера: (Выбрать все)',
      options: [
        'Четкие шаги',
        'Ожидаемые результаты',
        'Соответствующие данные',
        'Неоднозначный результат',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['qa', 'testing'],
      explanation: 'Ясность и ожидаемые результаты делают тесты надежными.',
    },
    {
      prompt: 'Распространенные источники ненадежных тестов: (Выбрать все)',
      options: [
        'Проблемы с асинхронной синхронизацией',
        'Общее состояние',
        'Случайные данные',
        'Детерминированные издевательства',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['qa', 'flaky'],
      explanation: 'Синхронизация, общее состояние и случайность вызывают нестабильность.',
    },
    {
      prompt: 'Дымовые тесты должны охватывать: (Выбрать все)',
      options: ['Авторизоваться', 'Основной поток пользователей', 'Платежи', 'Все крайние случаи'],
      correctIndexes: [0, 1, 2],
      tags: ['qa', 'release'],
      explanation: 'Дымовые тесты быстро проверяют основные функции.',
    },
  ],
  ordering: {
    prompt: 'Закажите шаги для проверки исправления ошибки.',
    options: [
      'Воспроизвести ошибку',
      'Получите фиксированную сборку',
      'Повторно протестируйте сценарий',
      'Закрыть билет',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['qa', 'workflow'],
    explanation: 'Воспроизведите, проверьте исправление и закройте.',
  },
  case: {
    prompt: 'Релиз завтра, но новая функция нестабильна. ',
    options: [
      'Отключите флаг функции и протестируйте основные потоки',
      'Все равно отправьте эту функцию',
      'Прекратить все тестирования',
      'Не обращайте внимания на нестабильность',
    ],
    correctIndex: 0,
    tags: ['qa', 'release'],
    explanation: 'Стабилизация основных потоков защищает релиз.',
  },
};

const QA_SECTION = buildSection('q_qa_', QA_TOPICS);

const DEVOPS_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Лучший первый шаг к улучшению наблюдаемости?',
      options: [
        'Добавляйте трассировки и структурированные журналы',
        'Удалить метрики',
        'Увеличьте шум бревен',
        'Отключить оповещения',
      ],
      correctIndex: 0,
      tags: ['devops', 'observability'],
      explanation: 'Трассировка и структурированные журналы позволяют ускорить отладку.',
    },
    {
      prompt: 'Что должно произойти в первую очередь во время инцидента?',
      options: [
        'Смягчение воздействия на пользователей',
        'Напишите вскрытие',
        'Услуги рефакторинга',
        'Обновление зависимостей',
      ],
      correctIndex: 0,
      tags: ['devops', 'incident'],
      explanation: 'Смягчение позволяет быстро восстановить обслуживание.',
    },
    {
      prompt: 'Проверки работоспособности контейнеров используются для:',
      options: [
        'Перезапустите неработоспособные экземпляры',
        'Увеличение использования ЦП',
        'Отключить мониторинг',
        'Принудительный ручной перезапуск',
      ],
      correctIndex: 0,
      tags: ['devops', 'containers'],
      explanation: 'Проверки состояния обеспечивают доступность услуг.',
    },
    {
      prompt: 'Стратегия безопасного развертывания рискованных изменений:',
      options: [
        'Канарский релиз',
        'Развертывание Большого взрыва',
        'Развертывание в пятницу вечером',
        'Пропустить мониторинг',
      ],
      correctIndex: 0,
      tags: ['devops', 'release'],
      explanation: 'Канареечные выпуски ограничивают радиус взрыва.',
    },
    {
      prompt: 'Секреты должны храниться в:',
      options: [
        'Секретный менеджер или хранилище',
        'Система контроля версий',
        'Обычный файл env в репо',
        'Клиентское хранилище',
      ],
      correctIndex: 0,
      tags: ['devops', 'security'],
      explanation: 'Секретные менеджеры обеспечивают контроль доступа и ротацию.',
    },
    {
      prompt: 'Лучший способ автоматического масштабирования веб-трафика:',
      options: [
        'Автомасштабирование по метрикам',
        'Только ручное масштабирование',
        'Отключить кеширование',
        'Часто перезагружайте серверы',
      ],
      correctIndex: 0,
      tags: ['devops', 'scaling'],
      explanation: 'Автомасштабирование реагирует на изменения спроса.',
    },
    {
      prompt: 'Резервные копии полезны только в том случае, если вы:',
      options: [
        'Тест восстанавливается регулярно',
        'Храните их на одном диске',
        'Никогда не проверять',
        'Игнорировать удержание',
      ],
      correctIndex: 0,
      tags: ['devops', 'reliability'],
      explanation: 'Тесты восстановления проверяют целостность резервной копии.',
    },
    {
      prompt: 'Инфраструктура как Кодекс должна быть:',
      options: [
        'Версия контролируется и проверяется',
        'Отредактировано вручную в производстве',
        'Сохранено в чате',
        'Только двоичный код',
      ],
      correctIndex: 0,
      tags: ['devops', 'iac'],
      explanation: 'Контроль версий обеспечивает возможность аудита и откат.',
    },
    {
      prompt: 'Конвейеры CI должны:',
      options: [
        'Быстро терпите неудачу при ошибках',
        'Игнорировать неудачные тесты',
        'Запуск без логов',
        'Пропускать линтинг всегда',
      ],
      correctIndex: 0,
      tags: ['devops', 'ci'],
      explanation: 'Быстрый отказ экономит время и деньги.',
    },
    {
      prompt: 'Обнаружен внезапный скачок затрат. ',
      options: [
        'Просмотрите использование ресурсов и политики масштабирования.',
        'игнорировать это',
        'Отключить мониторинг',
        'Добавить больше экземпляров',
      ],
      correctIndex: 0,
      tags: ['devops', 'cost'],
      explanation: 'Анализ затрат выявляет потери и неправильную конфигурацию.',
    },
  ],
  multi: [
    {
      prompt: 'Золотые сигналы для мониторинга включают в себя: (Выбрать все)',
      options: ['Задержка', 'Частота ошибок', 'Насыщенность', 'Количество встреч'],
      correctIndexes: [0, 1, 2],
      tags: ['devops', 'observability'],
      explanation: 'Золотые сигналы охватывают воздействие на пользователя и состояние системы.',
    },
    {
      prompt: 'Сообщение о происшествии должно включать: (Выбрать все)',
      options: [
        'Обновления статуса',
        'Внутренний канал координации',
        'Сводка по временной шкале',
        'Тишина',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['devops', 'incident'],
      explanation: 'Четкая коммуникация уменьшает путаницу во время инцидентов.',
    },
    {
      prompt: 'К безопасным методам CI/CD относятся: (Выбрать все)',
      options: [
        'Наименьшее количество жетонов привилегий',
        'Подписанные артефакты',
        'Секретное сканирование',
        'Учетные данные в журналах',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['devops', 'security'],
      explanation: 'Надежные трубопроводы защищают цепочку поставок.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите шаги реагирования на инцидент.',
    options: [
      'Обнаружение и сортировка',
      'Смягчить воздействие',
      'Статус сообщения',
      'Вскрытие и последующее наблюдение',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['devops', 'incident'],
    explanation: 'Реагируйте, стабилизируйтесь, общайтесь, а затем учитесь.',
  },
  case: {
    prompt: 'Развертывание вызывает всплеск ошибок. ',
    options: [
      'Откат и расследование',
      'Игнорировать оповещения',
      'Отключить мониторинг',
      'Масштабировать без изменений',
    ],
    correctIndex: 0,
    tags: ['devops', 'release'],
    explanation: 'Откат восстанавливает стабильность, пока не найдена основная причина.',
  },
};

const DEVOPS_SECTION = buildSection('q_ops_', DEVOPS_TOPICS);

const DATA_ENGINEER_TOPICS: SectionTopics = {
  single: [
    {
      prompt:
        'Выбирайте потоковую передачу или пакетную передачу, если вам нужна аналитика практически в реальном времени:',
      options: ['Потоковое вещание', 'Пакет раз в неделю', 'Ручной экспорт', 'Нет трубопровода'],
      correctIndex: 0,
      tags: ['data-engineer', 'streaming'],
      explanation:
        'Потоковая передача поддерживает сценарии использования, близкие к реальному времени.',
    },
    {
      prompt: 'Эволюция схемы должна отдавать предпочтение:',
      options: [
        'Обратная совместимость изменений',
        'Критические изменения без предварительного уведомления',
        'Немедленное удаление столбцов',
        'Случайные переименования',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'schema'],
      explanation: 'Обратная совместимость снижает количество сбоев конвейера.',
    },
    {
      prompt: 'Лучшая первая проверка качества данных:',
      options: [
        'Проверка нуля и диапазона',
        'Только случайная выборка',
        'Никаких проверок',
        'Ручной обзор Excel',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'data-quality'],
      explanation: 'Базовые ограничения позволяют выявить общие проблемы.',
    },
    {
      prompt: 'Для больших таблиц лучшим ключом секционирования часто является:',
      options: [
        'Дата или время',
        'Случайный идентификатор',
        'Имя пользователя',
        'Произвольный текст',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'storage'],
      explanation: 'Разделение по времени поддерживает эффективное сканирование.',
    },
    {
      prompt: 'Идемпотентные задания ETL должны:',
      options: [
        'Используйте контрольные точки или обновления',
        'Добавить вслепую',
        'Удалить все',
        'Запускать только один раз',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'etl'],
      explanation: 'Идемпотентность предотвращает дублирование данных.',
    },
    {
      prompt: 'Лучший способ обработки исторической обратной засыпки:',
      options: [
        'Запуск в контролируемых окнах',
        'Запускайте все сразу без ограничений',
        'Пропустить проверку',
        'Отключить мониторинг',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'etl'],
      explanation: 'Контролируемая засыпка снижает нагрузку и риск.',
    },
    {
      prompt: 'Линия передачи данных поможет вам:',
      options: [
        'Отслеживание источников данных и преобразований',
        'Скрыть зависимости',
        'Пропустить документацию',
        'Избегайте проверок',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'governance'],
      explanation: 'Lineage поддерживает отладку и соответствие требованиям.',
    },
    {
      prompt: 'Лучший формат хранения аналитики:',
      options: [
        'Столбчатый формат типа Паркет',
        'Только простой текст',
        'Случайные двоичные объекты',
        'только CSV',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'storage'],
      explanation: 'Столбчатые форматы повышают производительность запросов.',
    },
    {
      prompt: 'Трубопровод вышел из строя в середине пути. ',
      options: [
        'Повтор с последней контрольной точки',
        'Начать с нуля без проверок',
        'Не обращайте внимания на неудачу',
        'Удалить данные',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'reliability'],
      explanation: 'Контрольно-пропускные пункты позволяют избежать потери и дублирования данных.',
    },
    {
      prompt: 'Большое соединение выполняется медленно. ',
      options: [
        'Разделение и предварительное агрегирование',
        'Добавить больше столбцов',
        'Отключить индексы',
        'Запуск на одном узле',
      ],
      correctIndex: 0,
      tags: ['data-engineer', 'performance'],
      explanation:
        'Секционирование и предварительное агрегирование сокращают затраты на вычисления.',
    },
  ],
  multi: [
    {
      prompt: 'К параметрам качества данных относятся: (Выбрать все)',
      options: ['Полнота', 'Точность', 'Своевременность', 'Популярность'],
      correctIndexes: [0, 1, 2],
      tags: ['data-engineer', 'data-quality'],
      explanation: 'Основные измерения охватывают отсутствующие, неправильные и запоздалые данные.',
    },
    {
      prompt: 'Практика обеспечения надежности трубопроводов включает: (Выбрать все)',
      options: ['Повторные попытки с отсрочкой', 'Идемпотентность', 'Мониторинг', 'Тихие неудачи'],
      correctIndexes: [0, 1, 2],
      tags: ['data-engineer', 'reliability'],
      explanation:
        'Повторные попытки, идемпотентность и мониторинг обеспечивают стабильность конвейеров.',
    },
    {
      prompt: 'К методам обеспечения безопасности потоковой передачи относятся: (Выбрать все)',
      options: [
        'Водяные знаки',
        'Поздняя обработка данных',
        'Дедупликация',
        'Игнорирование заказа',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['data-engineer', 'streaming'],
      explanation: 'Водяные знаки и дедупликация повышают корректность потока.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите шаги по внедрению нового набора данных.',
    options: [
      'Определить схему и владение',
      'Прием необработанных данных',
      'Проверка качества',
      'Публикация для потребителей',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['data-engineer', 'workflow'],
    explanation: 'Перед публикацией проводится четкая схема и проверка.',
  },
  case: {
    prompt: 'Изменение схемы восходящего потока сломало работу. ',
    options: [
      'Добавить обработку совместимости и обратную засыпку',
      'Игнорировать изменение',
      'Удалить исторические данные',
      'Остановить трубопровод навсегда',
    ],
    correctIndex: 0,
    tags: ['data-engineer', 'schema'],
    explanation: 'Совместимость и обратная заливка восстанавливают корректность.',
  },
};

const DATA_ENGINEER_SECTION = buildSection('q_de_', DATA_ENGINEER_TOPICS);

const DATA_SCIENCE_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Модель использует будущие данные в функциях. ',
      options: ['Утечка данных', 'Регуляризация', 'Увеличение данных', 'Масштабирование функций'],
      correctIndex: 0,
      tags: ['ml', 'data-quality'],
      explanation: 'Утечка приводит к чрезмерно оптимистичным результатам.',
    },
    {
      prompt: 'В прогнозировании временных рядов следует использовать:',
      options: [
        'Разделение обучения/теста по времени',
        'Случайное разделение в случайном порядке',
        'Нет разделения',
        'Только тестовые данные',
      ],
      correctIndex: 0,
      tags: ['ml', 'validation'],
      explanation: 'Разделение по времени предотвращает утечку информации из будущего.',
    },
    {
      prompt: 'Выбор показателя должен:',
      options: [
        'Соответствие бизнес-результатам',
        'Быть случайным',
        'Всегда будьте точными',
        'Игнорировать классовый дисбаланс',
      ],
      correctIndex: 0,
      tags: ['ml', 'evaluation'],
      explanation: 'Показатели должны отражать реальный успех.',
    },
    {
      prompt: 'Дисбаланс классов лучше всего устраняется следующими способами:',
      options: [
        'Повторное взвешивание или повторная выборка',
        'Игнорирование класса меньшинства',
        'Удаление позитива',
        'Только точность',
      ],
      correctIndex: 0,
      tags: ['ml', 'training'],
      explanation: 'Изменение веса улучшает обучение на редких занятиях.',
    },
    {
      prompt: 'Хранилище функций используется для:',
      options: [
        'Повторное использование согласованных функций в разных моделях',
        'Хранить только необработанный CSV-файл',
        'Заменить базу данных',
        'Избегайте мониторинга',
      ],
      correctIndex: 0,
      tags: ['ml', 'feature-store'],
      explanation: 'Хранилища функций уменьшают перекос в обучении.',
    },
    {
      prompt: 'Неравномерность оффлайн/онлайн снижается за счет:',
      options: [
        'Использование одного и того же кода предварительной обработки',
        'Ручная копипаста',
        'Различные трубопроводы',
        'Случайные функции',
      ],
      correctIndex: 0,
      tags: ['ml', 'deployment'],
      explanation: 'Последовательная предварительная обработка уменьшает перекос.',
    },
    {
      prompt: 'Дрейф модели лучше всего обнаруживается с помощью:',
      options: [
        'Мониторинг данных и показателей производительности',
        'Ожидание отчетов пользователей',
        'Удаление логирования',
        'Только случайная выборка',
      ],
      correctIndex: 0,
      tags: ['ml', 'monitoring'],
      explanation: 'Обнаружение дрейфа требует постоянного мониторинга.',
    },
    {
      prompt: 'При настройке гиперпараметров следует использовать:',
      options: ['Набор проверки', 'Только обучающий набор', 'Только тестовый набор', 'Нет оценки'],
      correctIndex: 0,
      tags: ['ml', 'training'],
      explanation: 'Валидация предотвращает переобучение тестовому набору.',
    },
    {
      prompt: 'Для пояснения древовидных моделей можно использовать:',
      options: ['Ценности ШАП', 'Случайные числа', 'Только точность', 'Нет анализа'],
      correctIndex: 0,
      tags: ['ml', 'explainability'],
      explanation: 'SHAP предоставляет информацию о вкладе функций.',
    },
    {
      prompt: 'Новая модель готова к производству. ',
      options: [
        'Теневой или A/B-тест',
        'Немедленно заменить',
        'Отключить мониторинг',
        'Пропустить проверку',
      ],
      correctIndex: 0,
      tags: ['ml', 'deployment'],
      explanation: 'Теневое или A/B-тестирование снижает риск.',
    },
  ],
  multi: [
    {
      prompt: 'Сигналы утечки данных: (Выбрать все)',
      options: [
        'Нереально высокая точность',
        'Функции, полученные из цели',
        'Идеальный результат обучения',
        'Медленное обучение',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['ml', 'data-quality'],
      explanation: 'Утечка часто дает нереально сильные результаты.',
    },
    {
      prompt: 'Хорошее отслеживание эксперимента включает в себя: (Выбрать все)',
      options: [
        'Версия набора данных',
        'Гиперпараметры',
        'Метрики',
        'Только окончательное название модели',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['ml', 'experiments'],
      explanation: 'Отслеживание данных, параметров и показателей обеспечивает воспроизводимость.',
    },
    {
      prompt: 'Модель мониторинга должна смотреть: (Выбрать все)',
      options: ['Дрейф данных', 'Падение производительности', 'Задержка', 'Настроение команды'],
      correctIndexes: [0, 1, 2],
      tags: ['ml', 'monitoring'],
      explanation: 'Дрифт и производительность ухудшают реальные результаты.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите этапы изготовления модели.',
    options: [
      'Модель поезда',
      'Проверка показателей',
      'Упаковка и развертывание',
      'Монитор в производстве',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['ml', 'deployment'],
    explanation: 'Проверка предшествует развертыванию; ',
  },
  case: {
    prompt: 'Новая модель немного лучше работает в автономном режиме, но намного медленнее. ',
    options: [
      'Сначала запустите A/B-тест или оптимизируйте задержку.',
      'Развернуть немедленно',
      'Отклонить без анализа',
      'Отключить мониторинг',
    ],
    correctIndex: 0,
    tags: ['ml', 'performance'],
    explanation: 'Влияние задержки необходимо проверить перед развертыванием.',
  },
};

const DATA_SCIENCE_SECTION = buildSection('q_ml_', DATA_SCIENCE_TOPICS);

const SECURITY_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Лучшая защита от SQL-инъекций:',
      options: [
        'Параметризованные запросы',
        'Конкатенация строк',
        'Только проверка клиента',
        'Отключить журналы',
      ],
      correctIndex: 0,
      tags: ['security', 'owasp'],
      explanation: 'Параметризованные запросы предотвращают внедрение.',
    },
    {
      prompt: 'Безопасность сеанса должна включать в себя:',
      options: [
        'Ротация токенов',
        'Токены с неограниченным сроком действия',
        'Токены в URL',
        'Общие аккаунты',
      ],
      correctIndex: 0,
      tags: ['security', 'auth'],
      explanation: 'Ротация снижает риск кражи сеансов.',
    },
    {
      prompt: 'Секреты должны храниться в:',
      options: ['Секретный менеджер', 'Исходный код', 'Публичная вики', 'Клиентское хранилище'],
      correctIndex: 0,
      tags: ['security', 'secrets'],
      explanation: 'Секретные менеджеры обеспечивают контроль доступа и ротацию.',
    },
    {
      prompt: 'Наименьшие привилегии означают:',
      options: [
        'Предоставляйте только необходимые разрешения',
        'Дайте админа всем',
        'Поделитесь корневым доступом',
        'Отключить аудит',
      ],
      correctIndex: 0,
      tags: ['security', 'iam'],
      explanation: 'Ограничение доступа уменьшает радиус взрыва.',
    },
    {
      prompt: 'Моделирование угроз начинается с:',
      options: [
        'Выявление активов и угроз',
        'Выбор поставщика брандмауэра',
        'Сначала пишем код',
        'Отключение ведения журнала',
      ],
      correctIndex: 0,
      tags: ['security', 'threat-modeling'],
      explanation: 'Активы и угрозы определяют область действия модели.',
    },
    {
      prompt: 'Уязвимости зависимостей должны устраняться следующими способами:',
      options: [
        'Исправление и обновление',
        'Игнорирование',
        'Скрытие оповещений',
        'Закрепление старых версий навсегда',
      ],
      correctIndex: 0,
      tags: ['security', 'dependencies'],
      explanation: 'Исправление уменьшает воздействие.',
    },
    {
      prompt: 'Строгая аутентификация должна включать в себя:',
      options: [
        'Многофакторная аутентификация',
        'Повторное использование пароля',
        'Общие учетные данные',
        'Нет регистрации',
      ],
      correctIndex: 0,
      tags: ['security', 'auth'],
      explanation: 'MFA снижает риск захвата аккаунта.',
    },
    {
      prompt: 'Журналы должны избегать:',
      options: [
        'Конфиденциальные данные, такие как пароли',
        'Идентификаторы запроса',
        'Коды ошибок',
        'Тайминг',
      ],
      correctIndex: 0,
      tags: ['security', 'logging'],
      explanation: 'Конфиденциальные данные в журналах увеличивают последствия взлома.',
    },
    {
      prompt: 'Риск SSRF можно снизить путем:',
      options: [
        'Блокировка конечных точек внутренних метаданных',
        'Разрешение любого URL',
        'Отключение TLS',
        'Использование только GET',
      ],
      correctIndex: 0,
      tags: ['security', 'ssrf'],
      explanation: 'Блокировка внутренних конечных точек снижает влияние SSRF.',
    },
    {
      prompt: 'Для хранения паролей следует использовать:',
      options: [
        'Сильное хеширование, такое как bcrypt',
        'Обычный текст',
        'Обратимое шифрование',
        'Только клиентское хранилище',
      ],
      correctIndex: 0,
      tags: ['security', 'auth'],
      explanation: 'Сильное хеширование защищает сохраненные пароли.',
    },
  ],
  multi: [
    {
      prompt: 'Проверки проверки безопасного кода включают в себя: (выбрать все)',
      options: [
        'Проверка ввода',
        'Проверка подлинности',
        'Чувствительная регистрация',
        'Жестко закодированные секреты',
      ],
      correctIndexes: [0, 1],
      tags: ['security', 'review'],
      explanation:
        'Проверка достоверности и аутентификации предотвращает распространенные уязвимости.',
    },
    {
      prompt: 'Действия по реагированию на инциденты включают: (Выбрать все)',
      options: [
        'Отозвать учетные данные',
        'Исправление уязвимости',
        'Уведомить заинтересованные стороны',
        'Игнорировать доказательства',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['security', 'incident'],
      explanation: 'Сдерживание, устранение последствий и коммуникация имеют важное значение.',
    },
    {
      prompt: 'Безопасный дизайн API включает в себя: (Выбрать все)',
      options: [
        'Ограничение скорости',
        'Аутентификация',
        'Проверка схемы',
        'Разрешение конечных точек общедоступного администратора',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['security', 'api'],
      explanation: 'Эти меры контроля снижают риски злоупотреблений и инъекций.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите действия при обнаружении уязвимости.',
    options: [
      'Серьезность сортировки',
      'Исправьте и протестируйте',
      'Развернуть исправление',
      'Обзор после инцидента',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['security', 'incident'],
    explanation: 'Оцените, исправьте, разверните и затем улучшите.',
  },
  case: {
    prompt: 'Утечка стороннего API-ключа. ',
    options: [
      'Ротация ключей и аудит доступа',
      'Продолжайте использовать тот же ключ',
      'Скрыть только журналы',
      'Отключить мониторинг',
    ],
    correctIndex: 0,
    tags: ['security', 'secrets'],
    explanation: 'Ротация ключей и аудит снижают постоянный риск.',
  },
};

const SECURITY_SECTION = buildSection('q_sec_', SECURITY_TOPICS);

const GAMEDEV_TOPICS: SectionTopics = {
  single: [
    {
      prompt: 'Фиксированный временной шаг используется для:',
      options: [
        'Сохраняйте физику последовательной',
        'Увеличьте задержку ввода',
        'Более низкая частота кадров',
        'Пропустить обновления',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'engine'],
      explanation: 'Фиксированный временной шаг делает моделирование детерминированным.',
    },
    {
      prompt: 'Лучший способ уменьшить задержку ввода:',
      options: [
        'Прочитайте ввод как можно раньше и удерживайте время кадра на низком уровне.',
        'Добавьте больше постобработки',
        'Увеличьте задержку VSync.',
        'Пропустить ввод',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'performance'],
      explanation: 'Меньшее время кадра уменьшает воспринимаемую задержку.',
    },
    {
      prompt: 'Просадки кадров высокие. ',
      options: [
        'Профилируйте CPU/GPU и найдите узкие места',
        'Добавьте больше частиц',
        'Увеличить разрешение',
        'игнорировать',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'performance'],
      explanation: 'Профилирование выявляет реальное узкое место.',
    },
    {
      prompt: 'Удержание низкое. ',
      options: [
        'Добавьте прогресс и цели',
        'Удалить награды',
        'Добавьте более длинные уроки',
        'Отключить аналитику',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'design'],
      explanation: 'Системы прогресса способствуют удержанию сотрудников.',
    },
    {
      prompt: 'Экономика игры слишком грубая. ',
      options: [
        'Регулируйте вознаграждения с помощью телеметрии',
        'Сбросить весь прогресс',
        'Добавить больше платного доступа',
        'Игнорировать отзывы',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'balance'],
      explanation: 'Настройка с помощью телеметрии улучшает баланс.',
    },
    {
      prompt: 'Игровой цикл обычно должен:',
      options: [
        'Обновить, затем визуализировать',
        'Рендеринг, затем обновление',
        'Пропустить обновления',
        'Запускать только на входе',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'engine'],
      explanation: 'Обновление, а затем рендеринг обеспечивают согласованность состояния игры.',
    },
    {
      prompt: 'Сеть для экшн-игр должна способствовать:',
      options: [
        'Прогноз клиента со сверкой',
        'Рендеринг только на сервере',
        'Без интерполяции',
        'Блокирующий ввод',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'network'],
      explanation: 'Прогнозирование уменьшает воспринимаемую задержку.',
    },
    {
      prompt: 'Чтобы уменьшить выбросы GC, вам следует:',
      options: [
        'Используйте пул объектов',
        'Создавайте объекты каждый кадр',
        'Отключить кеширование',
        'Использовать случайное распределение',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'performance'],
      explanation: 'Объединение в пул снижает нагрузку на сбор мусора.',
    },
    {
      prompt: 'Пользовательский интерфейс заикается во время игры. ',
      options: [
        'Избегайте тяжелых обновлений пользовательского интерфейса за кадр.',
        'Добавьте больше анимаций',
        'Увеличить разрешение',
        'Блокировать ввод',
      ],
      correctIndex: 0,
      tags: ['gamedev', 'ui'],
      explanation: 'Сокращение работы пользовательского интерфейса стабилизирует время кадра.',
    },
    {
      prompt: 'Аналитика для воронок должна отслеживать:',
      options: ['Ключевые этапы прогресса', 'Только вылетает', 'Только ФПС', 'Ничего'],
      correctIndex: 0,
      tags: ['gamedev', 'analytics'],
      explanation: 'Метрики воронки показывают, где уходят игроки.',
    },
  ],
  multi: [
    {
      prompt: 'Способы уменьшения задержки ввода: (Выбрать все)',
      options: [
        'Меньшее время кадра',
        'Буферизация ввода',
        'Уменьшите задержку рендеринга',
        'Увеличьте постобработку',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['gamedev', 'performance'],
      explanation: 'Меньшая задержка и буферизация улучшают скорость реагирования.',
    },
    {
      prompt: 'К факторам удержания относятся: (выбрать все)',
      options: ['Ежедневные квесты', 'Награды за прогресс', 'Социальные функции', 'Удаление целей'],
      correctIndexes: [0, 1, 2],
      tags: ['gamedev', 'design'],
      explanation: 'Прогресс и социальные функции поддерживают интерес игроков.',
    },
    {
      prompt: 'При профилировании производительности следует проверить: (Выбрать все)',
      options: [
        'процессорное время',
        'Время графического процессора',
        'Нарисовать звонки',
        'Только текстуры',
      ],
      correctIndexes: [0, 1, 2],
      tags: ['gamedev', 'performance'],
      explanation: 'CPU/GPU и вызовы отрисовки выявляют узкие места рендеринга.',
    },
  ],
  ordering: {
    prompt: 'Упорядочите шаги, чтобы исправить снижение производительности.',
    options: [
      'Профиль для обнаружения узкого места',
      'Применить оптимизацию',
      'Проверить улучшение',
      'Добавьте регрессионный тест',
    ],
    correctOrder: [0, 1, 2, 3],
    tags: ['gamedev', 'performance'],
    explanation: 'Сначала измерьте, исправьте, проверьте, а затем предотвратите повторение.',
  },
  case: {
    prompt: 'Игроки жалуются, что гринд слишком медленный. ',
    options: [
      'Настройте награды и добавьте механику догона',
      'Игнорировать отзывы',
      'Полностью удалить прогресс',
      'Только повышайте цены',
    ],
    correctIndex: 0,
    tags: ['gamedev', 'balance'],
    explanation: 'Прогресс настройки устраняет проблемы, не нарушая экономику.',
  },
};

const GAMEDEV_SECTION = buildSection('q_gd_', GAMEDEV_TOPICS);

const SECTIONS: ExamQuestion[] = [
  ...FRONTEND_SECTION,
  ...BACKEND_SECTION,
  ...FULLSTACK_SECTION,
  ...MOBILE_SECTION,
  ...QA_SECTION,
  ...DEVOPS_SECTION,
  ...DATA_ENGINEER_SECTION,
  ...DATA_SCIENCE_SECTION,
  ...SECURITY_SECTION,
  ...GAMEDEV_SECTION,
];

export const EXAM_QUESTIONS: ExamQuestion[] = [...GENERAL_QUESTIONS, ...SECTIONS];

export const EXAM_QUESTIONS_BY_ID: Record<string, ExamQuestion> = EXAM_QUESTIONS.reduce(
  (acc, question) => {
    acc[question.id] = question;
    return acc;
  },
  {} as Record<string, ExamQuestion>,
);

const validateExamQuestions = (questions: ExamQuestion[]): void => {
  const ids = new Set<string>();
  for (const question of questions) {
    if (ids.has(question.id)) {
      console.error(`[exam] Duplicate id: ${question.id}`);
    }
    ids.add(question.id);

    if (!question.explanation || question.explanation.trim().length === 0) {
      console.error(`[exam] Missing explanation: ${question.id}`);
    }

    if (!question.tags || question.tags.length === 0) {
      console.error(`[exam] Missing tags: ${question.id}`);
    }

    const optionIds = question.options.map((option) => option.id);
    const uniqueOptionIds = new Set(optionIds);
    if (uniqueOptionIds.size !== optionIds.length) {
      console.error(`[exam] Duplicate option ids: ${question.id}`);
    }

    if (question.type === 'singleChoice' || question.type === 'caseDecision') {
      if (!optionIds.includes(question.correctOptionId)) {
        console.error(`[exam] Invalid correctOptionId: ${question.id}`);
      }
    }

    if (question.type === 'multiChoice') {
      const uniqueCorrect = new Set(question.correctOptionIds);
      if (uniqueCorrect.size !== question.correctOptionIds.length) {
        console.error(`[exam] Duplicate correctOptionIds: ${question.id}`);
      }
      if (question.correctOptionIds.length === 0) {
        console.error(`[exam] Empty correctOptionIds: ${question.id}`);
      }
      for (const correctId of question.correctOptionIds) {
        if (!optionIds.includes(correctId)) {
          console.error(`[exam] Invalid correctOptionIds: ${question.id}`);
          break;
        }
      }
    }

    if (question.type === 'ordering') {
      const order = question.correctOrderOptionIds;
      const uniqueOrder = new Set(order);
      if (uniqueOrder.size !== order.length) {
        console.error(`[exam] Duplicate correctOrderOptionIds: ${question.id}`);
      }
      if (order.length !== optionIds.length) {
        console.error(`[exam] Ordering length mismatch: ${question.id}`);
      }
      for (const id of order) {
        if (!optionIds.includes(id)) {
          console.error(`[exam] Invalid correctOrderOptionIds: ${question.id}`);
          break;
        }
      }
    }
  }
};

declare const ngDevMode: boolean | undefined;
const isDev = typeof ngDevMode !== 'undefined' && ngDevMode;
if (isDev) {
  validateExamQuestions(EXAM_QUESTIONS);
}
